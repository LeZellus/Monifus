{% extends 'base.html.twig' %}

{% block title %}Guifus | {{ parent() }}{% endblock %}

{% block body %}
    <div class="flex justify-center flex-col items-center space-y-4">
        {% for message in app.flashes('error') %}
            <p class="wrapper wrapper-style wrapper-red">{{ message }}</p>
        {% endfor %}

        {% if isUserLoggedIn %}
            {% if userGuild %}
                {# Lien vers la page de la guilde de l'utilisateur #}
                <a class="form-submit" href="{{ path('app_guilds_show', {'name': userGuild.name|replace({' ': '_'})}) }}">{{ userGuild.name }}</a>
                <a class="form-submit form-submit-youtube" href="{{ path('app_guilds_leave', {'name': userGuild.name}) }}">Quitter ma guilde</a>
            {% else %}
                {# Bouton pour créer une guilde #}
                <a class="form-submit" href="{{ path('app_guilds_new') }}">Créer une guilde</a>
            {% endif %}
        {% else %}
            {# Proposer de créer une guilde #}
            <a class="form-submit" href="{{ path('app_guilds_new') }}">Créer une guilde</a>
        {% endif %}
    </div>

    <section class="wrapper wrapper-style grid gap-4">
        <h2>Liste des guildes</h2>
        <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
            {% for guild in guilds %}
                {# Afficher les informations de chaque guilde #}
                <a href="{{ path('app_guilds_show', {'name': guild.name|replace({' ': '_'})}) }}" class="border rounded-lg border-gray-300 dark:border-gray-700 overflow-hidden group">
                    <div class="relative">
                        {% if guild.coverPicture %}
                            <img class="h-32 w-full object-cover" src="{{ asset("guilds/covers/" ~ guild.coverPicture) }}" alt="Image de couverture">
                        {% else %}
                            <img class="h-32 w-full object-cover" src="https://i81.servimg.com/u/f81/16/03/11/75/osmoz10.jpg" alt="Image de couverture">
                        {% endif %}

                        {% if guild.blasonPicture %}
                            <div class="h-24 w-24 rounded-full bg-cover overflow-hidden absolute z-10 left-1/2 transform -translate-x-1/2 top-[calc(100%-5rem)]" style="background-image: url('{{ asset("guilds/blasons/" ~ guild.blasonPicture) }}')"></div>
                        {% else %}
                            <div class="h-24 w-24 rounded-full bg-cover overflow-hidden absolute z-10 left-1/2 transform -translate-x-1/2 top-[calc(100%-5rem)]" style="background-image: url('{{ asset("uploads/blason.png") }}')"></div>
                        {% endif %}
                    </div>
                    {{ include("guild/includes/_content.html.twig") }}
                </a>
            {% endfor %}
        </div>
    </section>
{% endblock %}
